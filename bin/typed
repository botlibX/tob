#!/usr/bin/env python3
# This file is placed in the Public Domain.


"check type conversion"


import builtins
import inspect
import logging
import os
import sys


sys.path.insert(0, os.getcwd())


from tob.objects import Object
from tob.package import importer
from tob.serials import dumps, loads


import tob
import tob.brokers
import tob.caching
import tob.command
import tob.handler
import tob.message
import tob.methods
import tob.objects
import tob.package
import tob.serials
import tob.threads
import tob.timings
import tob.utility


from tob.objects import *


NAME = "tob"


PACKAGE = [
    'brokers',
    'caching',
    'command',
    'handler',
    'message',
    'methods',
    'objects',
    'package',
    'serials',
    'threads',
    'timings',
    'utility'
]


def func(event):
    event.reply("yo!")


ARGS = {
    'sleep': 60.0,
    'func': func
}


def members(mod):
    for name, tpe in inspect.getmembers(mod, inspect.isclass):
        if "_" in name:
            continue
        if name[0] == name[0].lower():
            continue
        if issubclass(tpe, BaseException):
            continue
        update(tpe, {"a": "b"})
        try:
            obj = tpe()
        except TypeError:
            arguments = inspect.signature(tpe)
            print(dir(arguments))
            args = []
            for arg in list(arguments.parameters):
                args.append(ARGS.get(arg, ""))
            try:
                obj = tpe(*args)
            except TypeError:
                print(f"missing type arguments for {tpe}{args}")
                continue
        txt = dumps(obj)
        oobj = loads(txt)
        print(name, oobj)

def main():
    for name in PACKAGE:
        modname = f"{NAME}.{name}"
        mod = importer(modname)
        members(mod)


if __name__ == "__main__":
    main()
    